SELECT customer_id, COUNT(*) AS count_no_trans FROM Visits WHERE visit_id  NO IN (SELECT DISTINCT visit_id FROM Transactions ) GROUP BY customer_id;